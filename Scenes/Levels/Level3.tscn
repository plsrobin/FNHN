[gd_scene load_steps=26 format=2]

[ext_resource path="res://Prefabs/player.tscn" type="PackedScene" id=1]
[ext_resource path="res://Assets/models/level3/room.glb" type="PackedScene" id=2]
[ext_resource path="res://Assets/models/level2/door/door.glb" type="PackedScene" id=3]
[ext_resource path="res://Assets/models/level3/steps/Steps.glb" type="PackedScene" id=4]
[ext_resource path="res://Assets/models/level3/roof/roof.glb" type="PackedScene" id=5]
[ext_resource path="res://Assets/models/level2/trapdoor/trapdoor.glb" type="PackedScene" id=6]
[ext_resource path="res://Prefabs/PSX_Furniture/Couch.tscn" type="PackedScene" id=7]
[ext_resource path="res://Scripts/detect_on_floor.gd" type="Script" id=8]
[ext_resource path="res://Prefabs/PSX_Furniture/Box.tscn" type="PackedScene" id=9]
[ext_resource path="res://Prefabs/PSX_Furniture/Fridge.tscn" type="PackedScene" id=10]
[ext_resource path="res://Prefabs/PSX_Furniture/Tv.tscn" type="PackedScene" id=11]
[ext_resource path="res://Prefabs/PSX_Furniture/Small_Table.tscn" type="PackedScene" id=12]
[ext_resource path="res://Prefabs/PSX_Furniture/TVStand.tscn" type="PackedScene" id=13]
[ext_resource path="res://Prefabs/PSX_Furniture/Toilet.tscn" type="PackedScene" id=14]
[ext_resource path="res://Prefabs/Oskar.tscn" type="PackedScene" id=15]
[ext_resource path="res://Prefabs/PSX_Furniture/Bed_Double.tscn" type="PackedScene" id=16]
[ext_resource path="res://Prefabs/PSX_Furniture/Bathtub.tscn" type="PackedScene" id=17]
[ext_resource path="res://Prefabs/PSX_Furniture/Dresser.tscn" type="PackedScene" id=18]
[ext_resource path="res://Prefabs/PSX_Furniture/Microwave.tscn" type="PackedScene" id=19]
[ext_resource path="res://Prefabs/PSX_Furniture/Pan.tscn" type="PackedScene" id=20]

[sub_resource type="NavigationMesh" id=6]
vertices = PoolVector3Array( -19.0718, 34.2832, -8.52872, -21.0718, 34.2832, -9.02872, -20.5718, 34.2832, -1.02872, -19.5718, 34.2832, -0.528721, -20.5718, 34.2832, 7.47128, -19.5718, 34.2832, 7.47128, -19.5718, 34.2832, -0.528721, -20.5718, 34.2832, -1.02872, -12.0718, 35.0332, 8.47128, -22.0718, 35.0332, 8.47128, -11.5718, 35.0332, 8.97128, 20.4282, 35.0332, -0.528721, 20.4282, 35.0332, -9.02872, 19.4282, 35.0332, -9.02872, 19.4282, 35.0332, -0.0287209, -11.5718, 35.0332, 8.97128, -0.571753, 35.0332, 8.97128, -1.57175, 35.0332, 8.47128, -12.0718, 35.0332, 8.47128, 20.4282, 35.0332, 7.97128, 20.4282, 35.0332, -0.528721, 19.4282, 35.0332, -0.0287209, 18.9282, 35.0332, 8.47128, -0.571753, 35.0332, 8.97128, 10.4282, 35.0332, 8.97128, 8.42825, 35.0332, 8.47128, -1.57175, 35.0332, 8.47128, 21.4282, 35.0332, 8.97128, 20.4282, 35.0332, 7.97128, 18.9282, 35.0332, 8.47128, 10.4282, 35.0332, 8.97128, 21.4282, 35.0332, 8.97128, 18.9282, 35.0332, 8.47128, 8.42825, 35.0332, 8.47128, 7.42825, 0.533236, -5.52872, 7.42825, 0.533236, -8.02872, 3.42825, 0.533236, -7.02872, -12.0718, 0.533236, -1.02872, -7.07175, 0.533236, -0.0287209, -6.57175, 0.533236, -1.52872, -12.0718, 0.533236, -4.02872, -18.5718, 0.533236, -1.02872, -14.5718, 0.533236, -1.02872, -14.0718, 0.533236, -4.52872, -18.5718, 0.533236, -8.02872, -4.57175, 0.533236, -0.528721, -5.57175, 0.533236, 0.971279, -4.57175, 0.533236, 6.97128, 6.92825, 0.533236, 7.47128, 7.42825, 0.533236, -5.52872, 3.42825, 0.533236, -7.02872, -8.07175, 0.533236, -8.02872, -12.0718, 0.533236, -4.02872, -6.57175, 0.533236, -1.52872, -5.07175, 0.533236, -2.02872, 3.42825, 0.533236, -7.02872, 2.92825, 0.533236, -8.02872, -8.07175, 0.533236, -8.02872, -18.5718, 0.533236, -8.02872, -14.0718, 0.533236, -4.52872, -12.0718, 0.533236, -4.02872, 3.42825, 0.533236, -7.02872, -5.07175, 0.533236, -2.02872, -4.57175, 0.533236, -0.528721, 16.9282, 0.533236, -3.52872, 18.4282, 0.533236, -4.02872, 18.4282, 0.533236, -8.02872, 9.42825, 0.533236, -8.02872, 9.42825, 0.533236, -5.52872, 18.4282, 0.533236, 7.47128, 18.4282, 0.533236, -1.02872, 16.9282, 0.533236, -1.52872, 16.9282, 0.533236, -1.52872, 9.42825, 0.533236, -5.52872, 7.42825, 0.533236, -5.52872, 6.92825, 0.533236, 7.47128, 18.4282, 0.533236, 7.47128, 16.9282, 0.533236, -1.52872, 16.9282, 0.533236, -3.52872, 9.42825, 0.533236, -5.52872, -14.0718, 0.533236, -0.0287209, -14.5718, 0.533236, -1.02872, -18.5718, 0.533236, -1.02872, -18.5718, 0.533236, 7.47128, -11.5718, 0.533236, 7.47128, -7.07175, 0.533236, -0.0287209, -12.0718, 0.533236, -1.02872, -12.5718, 0.533236, -0.0287209, -5.57175, 0.533236, 0.971279, -5.57175, 0.533236, 0.971279, -12.5718, 0.533236, -0.0287209, -14.0718, 0.533236, -0.0287209, -11.5718, 0.533236, 7.47128, -4.57175, 0.533236, 6.97128 )
polygons = [ PoolIntArray( 3, 2, 0 ), PoolIntArray( 0, 2, 1 ), PoolIntArray( 5, 4, 6 ), PoolIntArray( 6, 4, 7 ), PoolIntArray( 10, 9, 8 ), PoolIntArray( 12, 11, 13 ), PoolIntArray( 13, 11, 14 ), PoolIntArray( 18, 17, 15 ), PoolIntArray( 15, 17, 16 ), PoolIntArray( 20, 19, 21 ), PoolIntArray( 21, 19, 22 ), PoolIntArray( 26, 25, 23 ), PoolIntArray( 23, 25, 24 ), PoolIntArray( 27, 29, 28 ), PoolIntArray( 33, 32, 30 ), PoolIntArray( 30, 32, 31 ), PoolIntArray( 36, 35, 34 ), PoolIntArray( 38, 37, 39 ), PoolIntArray( 39, 37, 40 ), PoolIntArray( 42, 41, 43 ), PoolIntArray( 43, 41, 44 ), PoolIntArray( 46, 45, 47 ), PoolIntArray( 47, 45, 48 ), PoolIntArray( 48, 45, 50 ), PoolIntArray( 48, 50, 49 ), PoolIntArray( 53, 52, 54 ), PoolIntArray( 54, 52, 51 ), PoolIntArray( 54, 51, 56 ), PoolIntArray( 54, 56, 55 ), PoolIntArray( 60, 59, 57 ), PoolIntArray( 57, 59, 58 ), PoolIntArray( 63, 62, 61 ), PoolIntArray( 65, 64, 66 ), PoolIntArray( 66, 64, 68 ), PoolIntArray( 66, 68, 67 ), PoolIntArray( 71, 70, 69 ), PoolIntArray( 73, 72, 74 ), PoolIntArray( 74, 72, 76 ), PoolIntArray( 74, 76, 75 ), PoolIntArray( 79, 78, 77 ), PoolIntArray( 81, 80, 82 ), PoolIntArray( 82, 80, 83 ), PoolIntArray( 83, 80, 84 ), PoolIntArray( 86, 85, 87 ), PoolIntArray( 87, 85, 88 ), PoolIntArray( 91, 90, 92 ), PoolIntArray( 92, 90, 89 ), PoolIntArray( 92, 89, 93 ) ]
cell_size = 0.5
cell_height = 0.75

[sub_resource type="CubeMesh" id=4]
size = Vector3( 38, 0.1, 16.5 )

[sub_resource type="BoxShape" id=5]

[sub_resource type="BoxShape" id=3]
extents = Vector3( 19, 0, 8.5 )

[sub_resource type="BoxShape" id=7]

[node name="Spatial" type="Spatial"]

[node name="player" parent="." instance=ExtResource( 1 )]
transform = Transform( 0.0925443, 0, -0.995709, 0, 1, 0, 0.995709, 0, 0.0925443, -18.8976, 0, -2.78374 )

[node name="Navigation" type="Navigation" parent="."]

[node name="Oskar" parent="Navigation" instance=ExtResource( 15 )]
transform = Transform( -2.18557e-08, 0, -0.5, 0, 0.5, 0, 0.5, 0, -2.18557e-08, 8.91888, 0, -4.38213 )

[node name="NavigationMeshInstance" type="NavigationMeshInstance" parent="Navigation"]
navmesh = SubResource( 6 )

[node name="room" parent="Navigation/NavigationMeshInstance" instance=ExtResource( 2 )]
transform = Transform( 0.782509, 0, 0, 0, 1, 0, 0, 0, 0.420868, 0, -2.08163, 0 )

[node name="TVfbx_Scene" parent="Navigation/NavigationMeshInstance/room" instance=ExtResource( 11 )]
transform = Transform( 1.27794, 0, 0, 0, 1, 0, 0, 0, 2.37604, 10.5475, 1.83427, -17.5112 )

[node name="Fridgefbx_Scene" parent="Navigation/NavigationMeshInstance/room" instance=ExtResource( 10 )]
transform = Transform( 1.27794, 0, 0, 0, 0.00959912, 0.999954, 0, -2.37593, 0.0228079, 10.6746, 1.33237, -15.889 )

[node name="Steps" parent="Navigation/NavigationMeshInstance/room" instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 0.999999, 23.6292, 0.901779, -2.56009 )

[node name="Steps" parent="Navigation/NavigationMeshInstance/room/Steps" instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 0.999999, -0.129274, 2.78223, -5.74592 )

[node name="MeshInstance" type="MeshInstance" parent="Navigation/NavigationMeshInstance"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, -0.0752027 )
visible = false
mesh = SubResource( 4 )

[node name="StaticBody" type="StaticBody" parent="Navigation/NavigationMeshInstance/MeshInstance"]

[node name="CollisionShape" type="CollisionShape" parent="Navigation/NavigationMeshInstance/MeshInstance/StaticBody"]
shape = SubResource( 5 )
disabled = true

[node name="Furniture" type="Spatial" parent="Navigation/NavigationMeshInstance"]

[node name="Pan" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 20 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -13.071, 0.0714743, -1.41471 )

[node name="Microwave" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 19 )]
transform = Transform( -4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -12.9833, 0.0962769, -2.52719 )

[node name="Dresser" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 18 )]
transform = Transform( -8.74228e-08, 0, -2, 0, 1.5, 0, 2, 0, -8.74228e-08, -13.0822, -1.28746, -2.25933 )

[node name="Bathtub" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 17 )]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -12.5342, -1.28539, 7.11039 )

[node name="Boxes" type="Spatial" parent="Navigation/NavigationMeshInstance/Furniture"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -2.08163, 0 )

[node name="Boxfbx_Scene7" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.03166, 0.821003, 0.403234 )

[node name="Boxfbx_Scene" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.1737, 0.79283, -0.854609 )

[node name="Boxfbx_Scene2" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.04857, 0.792829, -0.840479 )

[node name="Boxfbx_Scene3" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.58894, 1.41865, -0.879211 )

[node name="Boxfbx_Scene4" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.03678, 0.792829, -0.102629 )

[node name="Boxfbx_Scene5" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.04353, 1.42454, -0.129762 )

[node name="Boxfbx_Scene6" parent="Navigation/NavigationMeshInstance/Furniture/Boxes" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.24925, 0.817232, 0 )

[node name="Bed_Double" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 16 )]
transform = Transform( 1.56502, 0, 0, 0, 1.5, 0, 0, 0, 1.68347, 4.78525, -0.55131, -6.58961 )

[node name="Tv" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 11 )]
transform = Transform( -1, 0, -8.74227e-08, 0, 1, 0, 8.74227e-08, 0, -0.999999, -4.33514, -0.50723, 7.78383 )

[node name="Small_Table" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 12 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 0.999999, -4.19312, -1.2888, 5.97637 )

[node name="Couch" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 7 )]
transform = Transform( -4.37114e-08, 0, -1, 0, 1, 0, 0.999999, 0, -4.37114e-08, -4.29366, -0.96775, 4.45165 )

[node name="TVStand" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 13 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 0.999999, -4.31109, -0.81871, 8.26913 )

[node name="Toilet" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 14 )]
transform = Transform( -1, 0, -8.74227e-08, 0, 1, 0, 8.74227e-08, 0, -0.999999, 8.21908, -1.2888, -5.86071 )

[node name="door" parent="Navigation/NavigationMeshInstance/Furniture" instance=ExtResource( 3 )]
transform = Transform( 0.00729295, 0, -0.733047, 0, 0.394214, 0, 0.541476, 0, 0.00472795, -19.2331, 0.38549, -2.93194 )

[node name="roof" parent="." instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1.86471, 0, 0, 0, 1, -0.86594, 5.75307, -2.76169 )

[node name="trapdoor" parent="roof" instance=ExtResource( 6 )]
transform = Transform( -4.37114e-08, -8.74228e-08, 1, 0, -0.536277, -4.68828e-08, 1, -3.82137e-15, 4.37114e-08, 19.141, 0.0417564, -3.12646 )

[node name="Floor" type="Area" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.20816, 0 )
script = ExtResource( 8 )

[node name="CollisionShape" type="CollisionShape" parent="Floor"]
shape = SubResource( 3 )

[node name="Waypoints" type="Spatial" parent="."]

[node name="wp1" type="Area" parent="Waypoints" groups=["waypoint"]]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 14.135, 0, 5.09515 )

[node name="CollisionShape" type="CollisionShape" parent="Waypoints/wp1"]
shape = SubResource( 7 )

[node name="wp2" type="Area" parent="Waypoints" groups=["waypoint"]]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.54117, 0, 5.09515 )

[node name="CollisionShape" type="CollisionShape" parent="Waypoints/wp2"]
shape = SubResource( 7 )

[node name="wp3" type="Area" parent="Waypoints" groups=["waypoint"]]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.54117, 0, -2.69024 )

[node name="CollisionShape" type="CollisionShape" parent="Waypoints/wp3"]
shape = SubResource( 7 )

[node name="wp4" type="Area" parent="Waypoints" groups=["waypoint"]]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 10.5852, 0, -2.69024 )

[node name="CollisionShape" type="CollisionShape" parent="Waypoints/wp4"]
shape = SubResource( 7 )

[connection signal="body_entered" from="Floor" to="Navigation/Oskar" method="_on_Floor_body_entered"]
[connection signal="body_entered" from="Floor" to="Floor" method="_on_Area_body_entered"]
[connection signal="body_exited" from="Floor" to="Navigation/Oskar" method="_on_Floor_body_exited"]
[connection signal="body_exited" from="Floor" to="Floor" method="_on_Area_body_exited"]
[connection signal="body_entered" from="Waypoints/wp1" to="Navigation/Oskar" method="_on_wp1_body_entered"]
[connection signal="body_entered" from="Waypoints/wp2" to="Navigation/Oskar" method="_on_wp2_body_entered"]
[connection signal="body_entered" from="Waypoints/wp3" to="Navigation/Oskar" method="_on_wp3_body_entered"]
[connection signal="body_entered" from="Waypoints/wp4" to="Navigation/Oskar" method="_on_wp4_body_entered"]
